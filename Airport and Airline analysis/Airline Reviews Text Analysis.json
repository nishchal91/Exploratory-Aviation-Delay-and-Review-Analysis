{"paragraphs":[{"title":"Load Packages","text":"%pyspark\n\nfrom pyspark.ml.feature import * \nfrom pyspark.sql.types import *\nfrom pyspark.sql.functions import *\nfrom pyspark.ml.linalg import Vectors, SparseVector\nfrom pyspark.ml.clustering import LDA, BisectingKMeans\nimport re","user":"anonymous","dateUpdated":"2017-05-10T19:59:27+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":[],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1494445077514_185020576","id":"20170220-223433_1029603904","dateCreated":"2017-05-10T19:37:57+0000","dateStarted":"2017-05-10T19:39:08+0000","dateFinished":"2017-05-10T19:39:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7345"},{"title":"Load Raw Data","text":"%pyspark\n\nfrom pyspark.sql import SQLContext\n\nsqlContext = SQLContext(sc)\n\n#read data without specifying schema\nrawdata = sqlContext.read.format('com.databricks.spark.csv').options(header='true', inferschema='true').load('/usr/zeppelin/big_data/airline.csv')\nrawdata = rawdata.fillna({'content': ''})      #Handle null entries                         \n","user":"anonymous","dateUpdated":"2017-05-10T19:59:27+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1494445077515_184635827","id":"20170220-223451_753954029","dateCreated":"2017-05-10T19:37:57+0000","dateStarted":"2017-05-10T19:39:10+0000","dateFinished":"2017-05-10T19:39:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7346"},{"title":"Tokenize data and remove stopwords","text":"%pyspark\n\n#Tokenize\ntokenizer = Tokenizer(inputCol=\"content\", outputCol=\"words\")\nwordsData = tokenizer.transform(rawdata)\n#wordsData.select('words').show(10)\n\n#Remove stopwords\nremover = StopWordsRemover(inputCol=\"words\", outputCol=\"filtered_words\")\nfiltered_words = remover.transform(wordsData)\n\nfiltered_words.select('filtered_words').show()\n","user":"anonymous","dateUpdated":"2017-05-10T19:59:27+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false},"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+\n|      filtered_words|\n+--------------------+\n|[outbound, flight...|\n|[two, short, hops...|\n|[flew, zurich-lju...|\n|[adria, serves, 1...|\n|[\"waw-skj, econom...|\n|[sarajevo-frankfu...|\n|[flights, paris, ...|\n|[lju, fra, back, ...|\n|[ljubljana, -, mu...|\n|[flights, lju, zr...|\n|[satisfied, crj, ...|\n|[jp650, evening, ...|\n|[vie-lju, lju-muc...|\n|[fly, regional, j...|\n|[istanbul-ljublja...|\n|[return, flight, ...|\n|[beg-lju-beg, crj...|\n|[fly, least, mont...|\n|[ltn, lju, outbou...|\n|[ljubljana, bruss...|\n+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1494445077516_182712082","id":"20170429-054020_1696823127","dateCreated":"2017-05-10T19:37:57+0000","dateStarted":"2017-05-10T19:42:16+0000","dateFinished":"2017-05-10T19:42:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7347"},{"text":"%pyspark\n\n#further ensure all stopwords are removed\ndef cleanup_text(words):\n    \n    # Default list of Stopwords\n    stopwords_core = ['a', u'about', u'above', u'after', u'again', u'against', u'all', u'am', u'an', u'and', u'any', u'are', u'arent', u'as', u'at', \n    u'be', u'because', u'been', u'before', u'being', u'below', u'between', u'both', u'but', u'by', \n    u'can', 'cant', 'come', u'could', 'couldnt', \n    u'd', u'did', u'didn', u'do', u'does', u'doesnt', u'doing', u'dont', u'down', u'during', \n    u'each', \n    u'few', 'finally', u'for', u'from', u'further', \n    u'had', u'hadnt', u'has', u'hasnt', u'have', u'havent', u'having', u'he', u'her', u'here', u'hers', u'herself', u'him', u'himself', u'his', u'how', \n    u'i', u'if', u'in', u'into', u'is', u'isnt', u'it', u'its', u'itself', \n    u'just', \n    u'll', \n    u'm', u'me', u'might', u'more', u'most', u'must', u'my', u'myself', \n    u'no', u'nor', u'not', u'now', \n    u'o', u'of', u'off', u'on', u'once', u'only', u'or', u'other', u'our', u'ours', u'ourselves', u'out', u'over', u'own', \n    u'r', u're', \n    u's', 'said', u'same', u'she', u'should', u'shouldnt', u'so', u'some', u'such', \n    u't', u'than', u'that', 'thats', u'the', u'their', u'theirs', u'them', u'themselves', u'then', u'there', u'these', u'they', u'this', u'those', u'through', u'to', u'too', \n    u'under', u'until', u'up', \n    u'very', \n    u'was', u'wasnt', u'we', u'were', u'werent', u'what', u'when', u'where', u'which', u'while', u'who', u'whom', u'why', u'will', u'with', u'wont', u'would', \n    u'y', u'you', u'your', u'yours', u'yourself', u'yourselves']\n    \n    # Custom stopwords to improve output\n    stopwords_custom = [u'flight',u'flights']\n    stopwords = stopwords_core + stopwords_custom\n    stopwords = [word.lower() for word in stopwords]    \n    \n    text_out = [re.sub('[^a-zA-Z0-9]','',word) for word in words]                                       # Remove special characters\n    text_out = [word.lower() for word in text_out if len(word)>2 and word.lower() not in stopwords]     # Remove stopwords and words under length 2\n    return text_out\n\n#define UDF\nudf_cleantext = udf(cleanup_text , ArrayType(StringType()))\n#Call above UDF by passing filtered words\nclean_text = filtered_words.withColumn(\"cleanwords\", udf_cleantext(filtered_words.filtered_words))\nclean_text.select('cleanwords').show()\n\n\n","user":"anonymous","dateUpdated":"2017-05-10T19:59:27+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+\n|          cleanwords|\n+--------------------+\n|[outbound, fraprn...|\n|[two, short, hops...|\n|[flew, zurichljub...|\n|[adria, serves, 1...|\n|[wawskj, economy,...|\n|[sarajevofrankfur...|\n|[paris, sarajevo,...|\n|[lju, fra, back, ...|\n|[ljubljana, munic...|\n|[lju, zrh, back, ...|\n|[satisfied, crj, ...|\n|[jp650, evening, ...|\n|[vielju, ljumuc, ...|\n|[fly, regional, j...|\n|[istanbulljubljan...|\n|[return, parissko...|\n|[begljubeg, crj20...|\n|[fly, least, mont...|\n|[ltn, lju, outbou...|\n|[ljubljana, bruss...|\n+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1494445077517_182327333","id":"20170429-054120_1791387821","dateCreated":"2017-05-10T19:37:57+0000","dateStarted":"2017-05-10T19:44:02+0000","dateFinished":"2017-05-10T19:44:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7348"},{"title":"Generate TF IDF Model","text":"%pyspark\n\n\ncv = CountVectorizer(inputCol=\"cleanwords\", outputCol=\"rawFeatures\", vocabSize = 1000)\ncvmodel = cv.fit(clean_text)\nfeaturizedData = cvmodel.transform(clean_text)\n\nvocab = cvmodel.vocabulary\nvocab_broadcast = sc.broadcast(vocab)\n\nidf = IDF(inputCol=\"rawFeatures\", outputCol=\"features\")\nidfModel = idf.fit(featurizedData)\nrescaledData = idfModel.transform(featurizedData)\nrescaledData.show()","user":"anonymous","dateUpdated":"2017-05-10T19:59:27+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false},"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+--------------------+--------------------+----------------+--------------+----------+--------------------+--------+--------------+--------------+-----+--------------+-------------------+------------------+---------------------+-----------------------------+---------------------+------------------------+------------------+-----------+--------------------+--------------------+--------------------+--------------------+--------------------+\n| airline_name|                link|               title|          author|author_country|      date|             content|aircraft|type_traveller|   cabin_flown|route|overall_rating|seat_comfort_rating|cabin_staff_rating|food_beverages_rating|inflight_entertainment_rating|ground_service_rating|wifi_connectivity_rating|value_money_rating|recommended|               words|      filtered_words|          cleanwords|         rawFeatures|            features|\n+-------------+--------------------+--------------------+----------------+--------------+----------+--------------------+--------+--------------+--------------+-----+--------------+-------------------+------------------+---------------------+-----------------------------+---------------------+------------------------+------------------+-----------+--------------------+--------------------+--------------------+--------------------+--------------------+\n|adria-airways|/airline-reviews/...|Adria Airways cus...|           D Ito|       Germany| 4/10/2015|Outbound flight F...|    null|          null|       Economy| null|             7|                  4|                 4|                    4|                            0|                 null|                    null|                 4|          1|[outbound, flight...|[outbound, flight...|[outbound, fraprn...|(1000,[5,14,17,22...|(1000,[5,14,17,22...|\n|adria-airways|/airline-reviews/...|Adria Airways cus...|    Ron Kuhlmann| United States|  1/5/2015|Two short hops ZR...|    null|          null|Business Class| null|            10|                  4|                 5|                    4|                            1|                 null|                    null|                 5|          1|[two, short, hops...|[two, short, hops...|[two, short, hops...|(1000,[2,4,6,31,4...|(1000,[2,4,6,31,4...|\n|adria-airways|/airline-reviews/...|Adria Airways cus...|         E Albin|   Switzerland| 9/14/2014|Flew Zurich-Ljubl...|    null|          null|       Economy| null|             9|                  5|                 5|                    4|                            0|                 null|                    null|                 5|          1|[flew, zurich-lju...|[flew, zurich-lju...|[flew, zurichljub...|(1000,[0,1,2,20,2...|(1000,[0,1,2,20,2...|\n|adria-airways|/airline-reviews/...|Adria Airways cus...|    Tercon Bojan|     Singapore|  9/6/2014|Adria serves this...|    null|          null|Business Class| null|             8|                  4|                 4|                    3|                            1|                 null|                    null|                 4|          1|[adria, serves, t...|[adria, serves, 1...|[adria, serves, 1...|(1000,[2,3,4,5,9,...|(1000,[2,3,4,5,9,...|\n|adria-airways|/airline-reviews/...|Adria Airways cus...|         L James|        Poland| 6/16/2014|\"WAW-SKJ Economy....|    null|          null|       Economy| null|             4|                  4|                 2|                    1|                            2|                 null|                    null|                 2|          0|[\"waw-skj, econom...|[\"waw-skj, econom...|[wawskj, economy,...|(1000,[0,13,16,23...|(1000,[0,13,16,23...|\n|adria-airways|/airline-reviews/...|Adria Airways cus...|      Dzano Edin|       Germany|  6/8/2014|Sarajevo-Frankfur...|    null|          null|       Economy| null|             9|                  4|                 4|                    3|                            3|                 null|                    null|                 4|          1|[sarajevo-frankfu...|[sarajevo-frankfu...|[sarajevofrankfur...|(1000,[0,6,12,13,...|(1000,[0,6,12,13,...|\n|adria-airways|/airline-reviews/...|Adria Airways cus...|   M Tushishvili|        France|  6/1/2014|I had flights fro...|    null|          null|       Economy| null|             5|                  4|                 4|                    1|                            0|                 null|                    null|                 3|          1|[i, had, flights,...|[flights, paris, ...|[paris, sarajevo,...|(1000,[0,1,3,27,4...|(1000,[0,1,3,27,4...|\n|adria-airways|/airline-reviews/...|Adria Airways cus...|        M Znidar|      Slovenia| 5/10/2014|LJU to FRA and ba...|    null|          null|       Economy| null|             9|                  5|                 5|                    4|                            3|                 null|                    null|                 4|          1|[lju, to, fra, an...|[lju, fra, back, ...|[lju, fra, back, ...|(1000,[0,1,4,7,10...|(1000,[0,1,4,7,10...|\n|adria-airways|/airline-reviews/...|Adria Airways cus...|    Tercon Bojan|     Singapore| 1/13/2014|On my Ljubljana -...|    null|          null|Business Class| null|             8|                  4|                 3|                    4|                            1|                 null|                    null|                 4|          1|[on, my, ljubljan...|[ljubljana, -, mu...|[ljubljana, munic...|(1000,[2,5,8,9,15...|(1000,[2,5,8,9,15...|\n|adria-airways|/airline-reviews/...|Adria Airways cus...|        M Znidar|      Slovenia|  1/6/2014|Flights from LJU ...|    null|          null|       Economy| null|            10|                  5|                 5|                    4|                            4|                 null|                    null|                 4|          1|[flights, from, l...|[flights, lju, zr...|[lju, zrh, back, ...|(1000,[1,6,9,10,1...|(1000,[1,6,9,10,1...|\n|adria-airways|/airline-reviews/...|Adria Airways cus...|  Aytek Cingitas|        Turkey|10/22/2013|I was very satisf...|    null|          null|       Economy| null|             9|                  4|                 4|                    4|                            4|                 null|                    null|                 4|          1|[i, was, very, sa...|[satisfied, crj, ...|[satisfied, crj, ...|(1000,[7,29,31,34...|(1000,[7,29,31,34...|\n|adria-airways|/airline-reviews/...|Adria Airways cus...|    Hashim Azlan|      Malaysia| 8/28/2013|I was on JP650 th...|    null|          null|       Economy| null|             7|                  4|                 5|                    3|                            3|                 null|                    null|                 5|          1|[i, was, on, jp65...|[jp650, evening, ...|[jp650, evening, ...|(1000,[1,6,14,22,...|(1000,[1,6,14,22,...|\n|adria-airways|/airline-reviews/...|Adria Airways cus...|        L Stefan|        Canada| 8/19/2013|VIE-LJU LJU-MUC A...|    null|          null|       Economy| null|             8|                  4|                 4|                    4|                            0|                 null|                    null|                 4|          1|[vie-lju, lju-muc...|[vie-lju, lju-muc...|[vielju, ljumuc, ...|(1000,[1,2,4,6,10...|(1000,[1,2,4,6,10...|\n|adria-airways|/airline-reviews/...|Adria Airways cus...|    Tercon Bojan|     Singapore| 8/19/2013|If I have to fly ...|    null|          null|Business Class| null|             7|                  3|                 3|                    4|                            1|                 null|                    null|                 4|          1|[if, i, have, to,...|[fly, regional, j...|[fly, regional, j...|(1000,[0,3,10,16,...|(1000,[0,3,10,16,...|\n|adria-airways|/airline-reviews/...|Adria Airways cus...|   Michael Asher|        Turkey| 6/10/2013|Istanbul-Ljubljan...|    null|          null|Business Class| null|             7|                  2|                 5|                    4|                            0|                 null|                    null|                 4|          1|[istanbul-ljublja...|[istanbul-ljublja...|[istanbulljubljan...|(1000,[1,2,4,6,10...|(1000,[1,2,4,6,10...|\n|adria-airways|/airline-reviews/...|Adria Airways cus...|   M Tushishvili|        France| 5/27/2013|Return flight Par...|    null|          null|       Economy| null|             5|                  4|                 4|                    1|                            0|                 null|                    null|                 4|          1|[return, flight, ...|[return, flight, ...|[return, parissko...|(1000,[1,2,4,6,11...|(1000,[1,2,4,6,11...|\n|adria-airways|/airline-reviews/...|Adria Airways cus...|Georgios Vrontos|        Greece| 10/8/2012|BEG-LJU-BEG with ...|    null|          null|       Economy| null|             9|                  4|                 5|                    4|                            0|                 null|                    null|                 2|          1|[beg-lju-beg, wit...|[beg-lju-beg, crj...|[begljubeg, crj20...|(1000,[0,1,2,13,1...|(1000,[0,1,2,13,1...|\n|adria-airways|/airline-reviews/...|Adria Airways cus...|          R Mahr|   Switzerland|  7/4/2012|I fly at least on...|    null|          null|       Economy| null|             5|               null|              null|                 null|                         null|                 null|                    null|                 4|          1|[i, fly, at, leas...|[fly, least, mont...|[fly, least, mont...|(1000,[7,19,22,33...|(1000,[7,19,22,33...|\n|adria-airways|/airline-reviews/...|Adria Airways cus...|        A Vlasov|United Kingdom| 6/17/2012|LTN to LJU outbou...|    null|          null|       Economy| null|             5|               null|              null|                 null|                         null|                 null|                    null|                 4|          1|[ltn, to, lju, ou...|[ltn, lju, outbou...|[ltn, lju, outbou...|(1000,[1,7,11,12,...|(1000,[1,7,11,12,...|\n|adria-airways|/airline-reviews/...|Adria Airways cus...|    Rok Urbancic|      Slovenia| 6/12/2012|Ljubljana to Brus...|    null|          null|       Economy| null|             8|               null|              null|                 null|                         null|                 null|                    null|                 1|          1|[ljubljana, to, b...|[ljubljana, bruss...|[ljubljana, bruss...|(1000,[1,6,10,29,...|(1000,[1,6,10,29,...|\n+-------------+--------------------+--------------------+----------------+--------------+----------+--------------------+--------+--------------+--------------+-----+--------------+-------------------+------------------+---------------------+-----------------------------+---------------------+------------------------+------------------+-----------+--------------------+--------------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1494445077518_183481580","id":"20170429-053553_1469294864","dateCreated":"2017-05-10T19:37:57+0000","dateStarted":"2017-05-10T19:44:09+0000","dateFinished":"2017-05-10T19:44:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7349"},{"title":"LDA Clustering","text":"%pyspark\n\n#K is chosen after several trials with different values. Seed is set to a constant value to ensure same results every time this is run on the data.\nlda = LDA(k=30, seed=123, optimizer=\"em\", featuresCol=\"features\")\n\nldamodel = lda.fit(rescaledData)\n\n\nldatopics = ldamodel.describeTopics()\n\ndef map_termID_to_Word(termIndices):\n    words = []\n    for termID in termIndices:\n        words.append(vocab_broadcast.value[termID])\n    \n    return words\n\nudf_map_termID_to_Word = udf(map_termID_to_Word , ArrayType(StringType()))\nldatopics_after_mapping = ldatopics.withColumn(\"topic_desc\", udf_map_termID_to_Word(ldatopics.termIndices))\nldatopics_after_mapping.select(ldatopics_after_mapping.topic, ldatopics_after_mapping.topic_desc).show(50,False)\n","user":"anonymous","dateUpdated":"2017-05-10T19:56:53+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+-------------------------------------------------------------------------+\n|topic|topic_desc                                                               |\n+-----+-------------------------------------------------------------------------+\n|0    |[seats, seat, time, plane, service, good, hours, staff, one, airline]    |\n|1    |[seat, class, seats, good, rouge, service, business, crew, plane, time]  |\n|2    |[good, class, seat, business, seats, service, cabin, crew, food, economy]|\n|3    |[seat, good, seats, class, service, plane, time, crew, cabin, food]      |\n|4    |[hours, plane, airport, told, time, get, one, staff, airline, seats]     |\n|5    |[time, plane, good, seat, seats, service, hours, staff, one, airline]    |\n|6    |[good, class, business, service, seat, seats, time, crew, food, plane]   |\n|7    |[class, seat, good, business, seats, economy, service, food, cabin, crew]|\n|8    |[good, class, seat, seats, service, business, crew, food, cabin, time]   |\n|9    |[good, class, seat, service, business, seats, crew, food, cabin, time]   |\n|10   |[good, class, seat, business, service, seats, cabin, food, crew, economy]|\n|11   |[abu, dhabi, class, good, seat, seats, business, service, food, crew]    |\n|12   |[good, service, seat, time, class, seats, plane, crew, food, business]   |\n|13   |[seat, good, seats, air, class, service, business, crew, time, food]     |\n|14   |[plane, hours, seat, seats, time, airport, good, service, one, crew]     |\n|15   |[seat, good, seats, service, time, class, crew, business, plane, staff]  |\n|16   |[plane, hours, time, airport, staff, good, seat, seats, crew, service]   |\n|17   |[class, seat, seats, good, business, service, time, crew, staff, food]   |\n|18   |[hours, plane, told, airport, time, seat, seats, staff, get, airline]    |\n|19   |[class, good, seat, business, seats, service, food, crew, time, cabin]   |\n|20   |[plane, hours, airport, time, told, get, one, seats, airline, service]   |\n|21   |[good, seat, class, service, seats, time, business, crew, staff, cabin]  |\n|22   |[class, good, seat, business, seats, service, food, crew, cabin, time]   |\n|23   |[good, class, seat, business, service, seats, sas, food, crew, time]     |\n|24   |[good, class, seat, business, seats, service, crew, food, cabin, time]   |\n|25   |[good, class, seat, service, seats, plane, time, staff, business, crew]  |\n|26   |[hours, told, plane, airport, time, get, delayed, one, airline, gate]    |\n|27   |[seat, seats, good, plane, time, service, crew, staff, one, class]       |\n|28   |[plane, hours, seats, seat, time, airport, airline, one, staff, get]     |\n|29   |[good, class, seat, seats, business, service, crew, time, cabin, food]   |\n+-----+-------------------------------------------------------------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1494445077519_183096831","id":"20170220-224919_1018722853","dateCreated":"2017-05-10T19:37:57+0000","dateStarted":"2017-05-10T19:56:53+0000","dateFinished":"2017-05-10T19:59:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7350"},{"title":"","text":"%pyspark\n\nldaResults = ldamodel.transform(rescaledData)\n\nldaResults.select('airline_name','date','cabin_flown','overall_rating','cleanwords','features','topicDistribution').show()","user":"anonymous","dateUpdated":"2017-05-10T19:57:02+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+----------+--------------+--------------+--------------------+--------------------+--------------------+\n| airline_name|      date|   cabin_flown|overall_rating|          cleanwords|            features|   topicDistribution|\n+-------------+----------+--------------+--------------+--------------------+--------------------+--------------------+\n|adria-airways| 4/10/2015|       Economy|             7|[outbound, fraprn...|(1000,[5,14,17,22...|[0.03126390640736...|\n|adria-airways|  1/5/2015|Business Class|            10|[two, short, hops...|(1000,[2,4,6,31,4...|[0.03237583217844...|\n|adria-airways| 9/14/2014|       Economy|             9|[flew, zurichljub...|(1000,[0,1,2,20,2...|[0.03294794017970...|\n|adria-airways|  9/6/2014|Business Class|             8|[adria, serves, 1...|(1000,[2,3,4,5,9,...|[0.03049219008580...|\n|adria-airways| 6/16/2014|       Economy|             4|[wawskj, economy,...|(1000,[0,13,16,23...|[0.03253596071004...|\n|adria-airways|  6/8/2014|       Economy|             9|[sarajevofrankfur...|(1000,[0,6,12,13,...|[0.03145371566423...|\n|adria-airways|  6/1/2014|       Economy|             5|[paris, sarajevo,...|(1000,[0,1,3,27,4...|[0.03206627928441...|\n|adria-airways| 5/10/2014|       Economy|             9|[lju, fra, back, ...|(1000,[0,1,4,7,10...|[0.03288743285161...|\n|adria-airways| 1/13/2014|Business Class|             8|[ljubljana, munic...|(1000,[2,5,8,9,15...|[0.03158877151581...|\n|adria-airways|  1/6/2014|       Economy|            10|[lju, zrh, back, ...|(1000,[1,6,9,10,1...|[0.03189637409716...|\n|adria-airways|10/22/2013|       Economy|             9|[satisfied, crj, ...|(1000,[7,29,31,34...|[0.03571948673884...|\n|adria-airways| 8/28/2013|       Economy|             7|[jp650, evening, ...|(1000,[1,6,14,22,...|[0.03643543819088...|\n|adria-airways| 8/19/2013|       Economy|             8|[vielju, ljumuc, ...|(1000,[1,2,4,6,10...|[0.03034408593231...|\n|adria-airways| 8/19/2013|Business Class|             7|[fly, regional, j...|(1000,[0,3,10,16,...|[0.03349619232620...|\n|adria-airways| 6/10/2013|Business Class|             7|[istanbulljubljan...|(1000,[1,2,4,6,10...|[0.02907960576498...|\n|adria-airways| 5/27/2013|       Economy|             5|[return, parissko...|(1000,[1,2,4,6,11...|[0.03245585556843...|\n|adria-airways| 10/8/2012|       Economy|             9|[begljubeg, crj20...|(1000,[0,1,2,13,1...|[0.03262872625123...|\n|adria-airways|  7/4/2012|       Economy|             5|[fly, least, mont...|(1000,[7,19,22,33...|[0.03313799089368...|\n|adria-airways| 6/17/2012|       Economy|             5|[ltn, lju, outbou...|(1000,[1,7,11,12,...|[0.03293439010453...|\n|adria-airways| 6/12/2012|       Economy|             8|[ljubljana, bruss...|(1000,[1,6,10,29,...|[0.03228065408734...|\n+-------------+----------+--------------+--------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1494445077519_183096831","id":"20170220-225152_721868555","dateCreated":"2017-05-10T19:37:57+0000","dateStarted":"2017-05-10T19:48:03+0000","dateFinished":"2017-05-10T19:48:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7351"},{"title":"","text":"%pyspark\n\ndef breakout_array(index_number, record):\n    vectorlist = record.tolist()\n    return vectorlist[index_number]\n\nudf_breakout_array = udf(breakout_array, FloatType())\n\n# Extract document weights for certain interesting topics\nenrichedData = ldaResults                                                                   \\\n        .withColumn(\"Topic_11\", udf_breakout_array(lit(11), ldaResults.topicDistribution))  \\\n        .withColumn(\"topic_28\", udf_breakout_array(lit(28), ldaResults.topicDistribution))            \n\nenrichedData.select('airline_name','date','cabin_flown','overall_rating','cleanwords','features','topicDistribution','Topic_11','Topic_28').show()\n","user":"anonymous","dateUpdated":"2017-05-10T19:59:27+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+----------+--------------+--------------+--------------------+--------------------+--------------------+-----------+-----------+\n| airline_name|      date|   cabin_flown|overall_rating|          cleanwords|            features|   topicDistribution|   Topic_11|   Topic_28|\n+-------------+----------+--------------+--------------+--------------------+--------------------+--------------------+-----------+-----------+\n|adria-airways| 4/10/2015|       Economy|             7|[outbound, fraprn...|(1000,[5,14,17,22...|[0.03126255375552...|0.032528847|0.030850073|\n|adria-airways|  1/5/2015|Business Class|            10|[two, short, hops...|(1000,[2,4,6,31,4...|[0.03237804177123...| 0.03411914| 0.03169313|\n|adria-airways| 9/14/2014|       Economy|             9|[flew, zurichljub...|(1000,[0,1,2,20,2...|[0.03295319929375...| 0.03323768|0.031549826|\n|adria-airways|  9/6/2014|Business Class|             8|[adria, serves, 1...|(1000,[2,3,4,5,9,...|[0.03049209017518...|0.036529675|0.029536424|\n|adria-airways| 6/16/2014|       Economy|             4|[wawskj, economy,...|(1000,[0,13,16,23...|[0.03255731364597...|0.034484696| 0.03312859|\n|adria-airways|  6/8/2014|       Economy|             9|[sarajevofrankfur...|(1000,[0,6,12,13,...|[0.03146051293631...|0.034029115|0.031294663|\n|adria-airways|  6/1/2014|       Economy|             5|[paris, sarajevo,...|(1000,[0,1,3,27,4...|[0.03208382158736...|0.034991257|0.032252382|\n|adria-airways| 5/10/2014|       Economy|             9|[lju, fra, back, ...|(1000,[0,1,4,7,10...|[0.03288848911186...|0.034429688|0.031860802|\n|adria-airways| 1/13/2014|Business Class|             8|[ljubljana, munic...|(1000,[2,5,8,9,15...|[0.03158639075739...| 0.03466291| 0.03088679|\n|adria-airways|  1/6/2014|       Economy|            10|[lju, zrh, back, ...|(1000,[1,6,9,10,1...|[0.03189001938613...|0.034996536| 0.03132704|\n|adria-airways|10/22/2013|       Economy|             9|[satisfied, crj, ...|(1000,[7,29,31,34...|[0.03571783662556...|0.034580793|0.031015387|\n|adria-airways| 8/28/2013|       Economy|             7|[jp650, evening, ...|(1000,[1,6,14,22,...|[0.03644506858902...|0.031520367|0.030443443|\n|adria-airways| 8/19/2013|       Economy|             8|[vielju, ljumuc, ...|(1000,[1,2,4,6,10...|[0.03034718481622...|0.033509854|0.030266063|\n|adria-airways| 8/19/2013|Business Class|             7|[fly, regional, j...|(1000,[0,3,10,16,...|[0.03349713164784...|0.035315566| 0.03253245|\n|adria-airways| 6/10/2013|Business Class|             7|[istanbulljubljan...|(1000,[1,2,4,6,10...|[0.02907849450942...| 0.03602404| 0.03036764|\n|adria-airways| 5/27/2013|       Economy|             5|[return, parissko...|(1000,[1,2,4,6,11...|[0.03246395243247...| 0.03453394| 0.03176711|\n|adria-airways| 10/8/2012|       Economy|             9|[begljubeg, crj20...|(1000,[0,1,2,13,1...|[0.03263171960963...| 0.03337716|0.034427002|\n|adria-airways|  7/4/2012|       Economy|             5|[fly, least, mont...|(1000,[7,19,22,33...|[0.03315656851622...|0.031881604|0.033463124|\n|adria-airways| 6/17/2012|       Economy|             5|[ltn, lju, outbou...|(1000,[1,7,11,12,...|[0.03293354397640...|0.030651126| 0.03515848|\n|adria-airways| 6/12/2012|       Economy|             8|[ljubljana, bruss...|(1000,[1,6,10,29,...|[0.03227795356933...|0.034204226| 0.03126748|\n+-------------+----------+--------------+--------------+--------------------+--------------------+--------------------+-----------+-----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1494445077521_193100303","id":"20170220-225002_1292271309","dateCreated":"2017-05-10T19:37:57+0000","dateStarted":"2017-05-10T19:48:16+0000","dateFinished":"2017-05-10T19:48:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7352"},{"text":"","dateUpdated":"2017-05-10T19:37:57+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1494445077531_190791809","id":"20170221-013200_2035804731","dateCreated":"2017-05-10T19:37:57+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7353"}],"name":"Airline Reviews Text Analysis","id":"2CG7GKFDB","angularObjects":{"2CF6VFX1U:shared_process":[],"2CF8EXPZJ:shared_process":[],"2CJ5GV88C:shared_process":[],"2CHZ415X5:shared_process":[],"2CF3WC5DB:shared_process":[],"2CF2F1NVK:shared_process":[],"2CH1Z9K5Q:shared_process":[],"2CGE2CFPR:shared_process":[],"2CHHBFH6V:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}