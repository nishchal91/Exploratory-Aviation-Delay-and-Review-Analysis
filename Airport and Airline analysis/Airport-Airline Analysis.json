{"paragraphs":[{"text":"val spark = org.apache.spark.sql.SparkSession.builder\n        .master(\"local\")\n        .appName(\"Spark CSV Reader\")\n        .getOrCreate;\n\nval df1 = spark.read\n        .format(\"com.databricks.spark.csv\")\n        .option(\"header\", \"true\") //reading the headers\n        .option(\"mode\", \"DROPMALFORMED\")\n        .load(\"/usr/zeppelin/big_data/airline.csv\");\n        \nprint(\"Airline Results\");        \n        \ndf1.registerTempTable(\"names\");\n//df1.head();\n//overall_rating\nprint(\"Overall Rating\");\nspark.sql(\"select airline_name,avg(overall_rating) as averagerating from names group by airline_name having count(airline_name) >300 order by averagerating desc limit 20\").show();\n//most_recommended\nprint(\"Most Recommended\");\nspark.sql(\"select airline_name from(select airline_name, count(*) as no_of_recos from names where recommended = '1' group by airline_name having no_of_recos > 200 order by no_of_recos desc limit 20) a\").show();\n//most_comfort_rating\nprint(\"Most Comfortable Seats\");\nspark.sql(\"select airline_name,avg(seat_comfort_rating) as best_seats from names group by airline_name having count(airline_name) >200 order by best_seats desc limit 20\").show();\n//value_for_money\nprint(\"Value for money\");\nspark.sql(\"select airline_name, avg(value_money_rating) value_for_money from names group by airline_name having count(airline_name)>200 order by value_for_money desc limit 20\").show();\n\nval spark = org.apache.spark.sql.SparkSession.builder\n        .master(\"local\")\n        .appName(\"Spark CSV Reader\")\n        .getOrCreate;\n\nval df1 = spark.read\n        .format(\"com.databricks.spark.csv\")\n        .option(\"header\", \"true\") //reading the headers\n        .option(\"mode\", \"DROPMALFORMED\")\n        .load(\"/usr/zeppelin/big_data/airport.csv\");\n\nprint(\"Airport Results\");        \ndf1.registerTempTable(\"airports\");\n//df1.head();\n//overall_rating\nprint(\"Overall Rating\");\nspark.sql(\"select airport_name,avg(overall_rating) as averagerating from airports group by airport_name having count(airport_name) >70 order by averagerating desc limit 20\").show();\n//most_recommended\nprint(\"Most Recommended\");\nspark.sql(\"select airport_name from(select airport_name, count(*) as no_of_recos from airports where recommended = '1' group by airport_name having no_of_recos > 70 order by no_of_recos desc limit 20) a\").show();\n//least_queuing_time\nprint(\"Least Queuing Times\");\nspark.sql(\"select airport_name,avg(queuing_rating) as queuing_rating from airports group by airport_name having count(airport_name) > 70 order by queuing_rating desc limit 20\").show();\n//most_clean\nprint(\"Most Clean\");\nspark.sql(\"select airport_name,avg(terminal_cleanliness_rating) as terminal_cleanliness_rating from airports group by airport_name having count(airport_name) > 70 order by terminal_cleanliness_rating desc limit 20\").show();\n//best_shopping_experience\nprint(\"Best Shopping Experience\");\nspark.sql(\"select airport_name,avg(airport_shopping_rating) as airport_shopping_rating from airports group by airport_name having count(airport_name) > 70 order by airport_shopping_rating desc limit 20\").show();\n//spark.sql(\"SELECT AVG(a.acount) FROM (select count(author_country) as acount FROM airports  GROUP BY author_country) a\").show();\n//spark.sql(\"select author_country,avg(overall_rating) as averagerating from airports group by author_country having count(author_country)>100 order by averagerating desc limit 20\").show();\n\n","dateUpdated":"2017-05-10T20:04:28+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nspark: org.apache.spark.sql.SparkSession = org.apache.spark.sql.SparkSession@7ba3445d\n\ndf1: org.apache.spark.sql.DataFrame = [airline_name: string, link: string ... 18 more fields]\nAirline Results\nwarning: there was one deprecation warning; re-run with -deprecation for details\nOverall Rating+--------------------+------------------+\n|        airline_name|     averagerating|\n+--------------------+------------------+\n|     asiana-airlines| 8.348837209302326|\n|    garuda-indonesia| 8.325714285714286|\n|          korean-air| 8.034920634920635|\n|             eva-air| 7.976351351351352|\n|  singapore-airlines| 7.779582366589327|\n|             easyjet| 7.370757180156658|\n|       qatar-airways|7.3264462809917354|\n|          aer-lingus| 7.285340314136126|\n|klm-royal-dutch-a...| 7.191860465116279|\n|swiss-internation...| 7.180379746835443|\n|      qantas-airways| 7.005199306759099|\n|           lufthansa| 7.005025125628141|\n|           norwegian|7.0027027027027025|\n|china-southern-ai...| 6.964912280701754|\n|        thai-airways|6.9527777777777775|\n|            jet2-com|  6.95016611295681|\n|cathay-pacific-ai...| 6.904276985743381|\n|  southwest-airlines|6.8544303797468356|\n|     air-new-zealand| 6.722419928825623|\n|             ryanair| 6.566218809980806|\n+--------------------+------------------+\n\nMost Recommended+--------------------+\n|        airline_name|\n+--------------------+\n|     british-airways|\n|           lufthansa|\n|            emirates|\n|      qantas-airways|\n|       qatar-airways|\n|  singapore-airlines|\n|             ryanair|\n|         jet-airways|\n|cathay-pacific-ai...|\n|   malaysia-airlines|\n|    garuda-indonesia|\n|china-southern-ai...|\n|             easyjet|\n|    turkish-airlines|\n|          aer-lingus|\n|           norwegian|\n|        thai-airways|\n|     asiana-airlines|\n|klm-royal-dutch-a...|\n|          korean-air|\n+--------------------+\n\nMost Comfortable Seats+--------------------+------------------+\n|        airline_name|        best_seats|\n+--------------------+------------------+\n|    garuda-indonesia| 4.353276353276353|\n|     asiana-airlines| 4.103585657370518|\n|             eva-air| 4.056910569105691|\n|          korean-air| 3.923344947735192|\n|       qatar-airways|  3.87396694214876|\n|royal-brunei-airl...|3.8633879781420766|\n|  singapore-airlines|3.8468677494199537|\n|     bangkok-airways|3.7974683544303796|\n|china-southern-ai...| 3.778588807785888|\n|cathay-pacific-ai...|3.7474541751527495|\n|     jetblue-airways| 3.736559139784946|\n|     aegean-airlines| 3.736040609137056|\n|           airasia-x| 3.732824427480916|\n|      qantas-airways|3.6915077989601386|\n|      virgin-america| 3.611111111111111|\n|            emirates|3.5956521739130434|\n|           air-india|3.5907692307692307|\n|        thai-airways| 3.558333333333333|\n|           norwegian| 3.545685279187817|\n|aeroflot-russian-...|3.5270935960591134|\n+--------------------+------------------+\n\nValue for money+--------------------+------------------+\n|        airline_name|   value_for_money|\n+--------------------+------------------+\n|    garuda-indonesia| 4.316239316239316|\n|     asiana-airlines| 4.254125412541254|\n|       qatar-airways| 4.177685950413223|\n|royal-brunei-airl...| 4.109433962264151|\n|          korean-air| 4.078175895765472|\n|             eva-air| 4.062913907284768|\n|china-southern-ai...| 4.019464720194647|\n|           airasia-x| 4.003952569169961|\n|  singapore-airlines| 3.925754060324826|\n|aeroflot-russian-...| 3.865546218487395|\n|   malaysia-airlines|3.8181818181818183|\n|     bangkok-airways|3.7918781725888326|\n|        thai-airways| 3.736111111111111|\n|cathay-pacific-ai...|3.7311608961303464|\n|     aegean-airlines| 3.726890756302521|\n|           lufthansa|3.6884422110552766|\n|             airasia|3.6785714285714284|\n|             easyjet|3.6719101123595506|\n|      virgin-america|3.6444444444444444|\n|ana-all-nippon-ai...| 3.639705882352941|\n+--------------------+------------------+\n\n\nspark: org.apache.spark.sql.SparkSession = org.apache.spark.sql.SparkSession@7ba3445d\n\ndf1: org.apache.spark.sql.DataFrame = [airport_name: string, link: string ... 18 more fields]\nAirport Results\nwarning: there was one deprecation warning; re-run with -deprecation for details\nOverall Rating+--------------------+------------------+\n|        airport_name|     averagerating|\n+--------------------+------------------+\n|singapore-changi-...| 7.111731843575419|\n|     incheon-airport| 6.981132075471698|\n|   hong-kong-airport| 6.197452229299363|\n|       delhi-airport|  5.76984126984127|\n|      zurich-airport| 5.716216216216216|\n|klia-kuala-lumpur...| 5.590277777777778|\n|amsterdam-schipho...| 5.549019607843137|\n|    auckland-airport| 5.506024096385542|\n|tokyo-narita-airport|5.4035087719298245|\n|helsinki-vantaa-a...|5.3584905660377355|\n|      munich-airport| 5.304347826086956|\n|   vancouver-airport|              5.25|\n|london-heathrow-a...| 4.880281690140845|\n|      dublin-airport| 4.873873873873874|\n|   newcastle-airport| 4.728813559322034|\n|dallas-fort-worth...| 4.714285714285714|\n|      sydney-airport|4.6173913043478265|\n|atlanta-hartsfiel...|  4.56043956043956|\n|  copenhagen-airport| 4.552941176470588|\n|london-gatwick-ai...| 4.497695852534562|\n+--------------------+------------------+\n\nMost Recommended+--------------------+\n|        airport_name|\n+--------------------+\n|london-heathrow-a...|\n|singapore-changi-...|\n|london-gatwick-ai...|\n|   hong-kong-airport|\n|amsterdam-schipho...|\n+--------------------+\n\nLeast Queuing Times+--------------------+------------------+\n|        airport_name|    queuing_rating|\n+--------------------+------------------+\n|singapore-changi-...|4.3609467455621305|\n|     incheon-airport|3.9074074074074074|\n|      zurich-airport|3.7866666666666666|\n|   hong-kong-airport|3.6842105263157894|\n|      munich-airport|              3.64|\n|helsinki-vantaa-a...| 3.604651162790698|\n|tokyo-narita-airport|               3.6|\n|    auckland-airport|3.5357142857142856|\n|   newcastle-airport|3.4468085106382977|\n|klia-kuala-lumpur...|3.3734177215189876|\n|      vienna-airport|3.3058823529411763|\n|   vancouver-airport|             3.275|\n|       delhi-airport| 3.223076923076923|\n|  copenhagen-airport| 3.095890410958904|\n|        doha-airport|3.0792079207920793|\n|shanghai-pudong-a...|               3.0|\n|beijing-capital-a...|               3.0|\n|      dublin-airport| 2.981818181818182|\n|milan-malpensa-ai...| 2.972972972972973|\n|madrid-barajas-ai...|2.9382716049382718|\n+--------------------+------------------+\n\nMost Clean+--------------------+---------------------------+\n|        airport_name|terminal_cleanliness_rating|\n+--------------------+---------------------------+\n|     incheon-airport|          4.814814814814815|\n|      zurich-airport|                        4.8|\n|singapore-changi-...|           4.78698224852071|\n|tokyo-narita-airport|                        4.7|\n|   hong-kong-airport|          4.427631578947368|\n|      munich-airport|          4.386666666666667|\n|helsinki-vantaa-a...|          4.372093023255814|\n|   vancouver-airport|                     4.2125|\n|beijing-capital-a...|          4.148648648648648|\n|       delhi-airport|          4.107692307692307|\n|    auckland-airport|          4.035714285714286|\n|amsterdam-schipho...|          3.933333333333333|\n|toronto-pearson-a...|                    3.91875|\n|atlanta-hartsfiel...|          3.904255319148936|\n|shanghai-pudong-a...|         3.8983050847457625|\n|      vienna-airport|          3.823529411764706|\n|      dublin-airport|         3.8181818181818183|\n|  copenhagen-airport|          3.808219178082192|\n|dallas-fort-worth...|                       3.76|\n|bangkok-suvarnabh...|         3.7534246575342465|\n+--------------------+---------------------------+\n\nBest Shopping Experience+--------------------+-----------------------+\n|        airport_name|airport_shopping_rating|\n+--------------------+-----------------------+\n|singapore-changi-...|      4.658682634730539|\n|     incheon-airport|      4.407407407407407|\n|   hong-kong-airport|      4.157894736842105|\n|      zurich-airport|      3.986666666666667|\n|   vancouver-airport|     3.8846153846153846|\n|      munich-airport|      3.864864864864865|\n|tokyo-narita-airport|     3.7666666666666666|\n|amsterdam-schipho...|     3.7378048780487805|\n|       delhi-airport|     3.5923076923076924|\n|helsinki-vantaa-a...|                    3.5|\n|    auckland-airport|     3.4642857142857144|\n|klia-kuala-lumpur...|      3.430379746835443|\n|london-heathrow-a...|      3.430255402750491|\n|dallas-fort-worth...|     3.3877551020408165|\n|      dublin-airport|      3.302752293577982|\n|  copenhagen-airport|      3.232876712328767|\n|atlanta-hartsfiel...|       3.21978021978022|\n|bangkok-suvarnabh...|     3.1963470319634704|\n|  birmingham-airport|      3.080357142857143|\n|london-gatwick-ai...|     3.0326530612244897|\n+--------------------+-----------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1494446397451_722784046","id":"20170417-155857_1667987017","dateCreated":"2017-05-10T19:59:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6074","user":"anonymous","dateFinished":"2017-05-10T20:04:48+0000","dateStarted":"2017-05-10T20:04:28+0000"},{"text":"%sql\n","dateUpdated":"2017-05-10T19:59:57+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true,"editorSetting":{"language":"sql","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1494446397454_721629800","id":"20170417-160348_1362393289","dateCreated":"2017-05-10T19:59:57+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:6076"}],"name":"Airport/Airline Analysis","id":"2CFXN9Y7W","angularObjects":{"2CF6VFX1U:shared_process":[],"2CF8EXPZJ:shared_process":[],"2CJ5GV88C:shared_process":[],"2CHZ415X5:shared_process":[],"2CF3WC5DB:shared_process":[],"2CF2F1NVK:shared_process":[],"2CH1Z9K5Q:shared_process":[],"2CGE2CFPR:shared_process":[],"2CHHBFH6V:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}