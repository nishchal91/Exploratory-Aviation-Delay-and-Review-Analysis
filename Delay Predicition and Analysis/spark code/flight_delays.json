{"paragraphs":[{"text":"import scala.collection.mutable.WrappedArray\r\nimport spark.implicits._\r\nimport org.apache.spark.sql.functions._\r\n\r\n val spark = org.apache.spark.sql.SparkSession.builder\r\n        .master(\"local\")\r\n        .appName(\"Spark CSV Reader\")\r\n        .getOrCreate;\r\n\r\nval ds2006 = spark.read\r\n        .format(\"com.databricks.spark.csv\")\r\n        .option(\"header\", \"true\") //reading the headers\r\n        .option(\"mode\", \"DROPMALFORMED\")\r\n        .load(\"/usr/nishchal/Nishchal/bigData/flight/2006.csv\"); \r\nval ds2007 = spark.read\r\n        .format(\"com.databricks.spark.csv\")\r\n        .option(\"header\", \"true\") //reading the headers\r\n        .option(\"mode\", \"DROPMALFORMED\")\r\n        .load(\"/usr/nishchal/Nishchal/bigData/flight/2007.csv\"); \r\n\r\nds2006.registerTempTable(\"flightDelays_2006\"); \r\nds2007.registerTempTable(\"flightDelays_2007\");\r\nval df2=spark.sql(\"select cast(CRSDepTime/100 as int) as timeOfDay,origin from flightDelays_2006 where DepDelay>=15 and Origin in ('JFK','LAX','SFO') union all select cast(CRSDepTime/100 as int) as timeOfDay,origin from flightDelays_2007 where DepDelay>=15 and Origin in ('JFK','LAX','SFO')\");\r\ndf2.registerTempTable(\"timeOfDayAndOrigin\");\r\nval df3=spark.sql(\"select timeOfDay,origin,count(*) as numberOfDelayedFlights from timeOfDayAndOrigin group by timeOfDay,origin order by timeOfDay,origin\");\r\ndf3.show(72,false);\r\n","user":"anonymous","dateUpdated":"2017-05-09T02:19:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport scala.collection.mutable.WrappedArray\n\nimport spark.implicits._\n\nimport org.apache.spark.sql.functions._\n\nspark: org.apache.spark.sql.SparkSession = org.apache.spark.sql.SparkSession@17f7ab8e\n\nds2006: org.apache.spark.sql.DataFrame = [Year: string, Month: string ... 27 more fields]\n\nds2007: org.apache.spark.sql.DataFrame = [Year: string, Month: string ... 27 more fields]\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\ndf2: org.apache.spark.sql.DataFrame = [timeOfDay: int, origin: string]\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\ndf3: org.apache.spark.sql.DataFrame = [timeOfDay: int, origin: string ... 1 more field]\n+---------+------+----------------------+\n|timeOfDay|origin|numberOfDelayedFlights|\n+---------+------+----------------------+\n|0        |JFK   |2                     |\n|0        |LAX   |699                   |\n|0        |SFO   |369                   |\n|1        |LAX   |104                   |\n|1        |SFO   |12                    |\n|2        |JFK   |1                     |\n|5        |JFK   |165                   |\n|5        |LAX   |31                    |\n|5        |SFO   |3                     |\n|6        |JFK   |986                   |\n|6        |LAX   |1451                  |\n|6        |SFO   |977                   |\n|7        |JFK   |1297                  |\n|7        |LAX   |2607                  |\n|7        |SFO   |1745                  |\n|8        |JFK   |4001                  |\n|8        |LAX   |3516                  |\n|8        |SFO   |2496                  |\n|9        |JFK   |3108                  |\n|9        |LAX   |3736                  |\n|9        |SFO   |2441                  |\n|10       |JFK   |1763                  |\n|10       |LAX   |5392                  |\n|10       |SFO   |4883                  |\n|11       |JFK   |1693                  |\n|11       |LAX   |5360                  |\n|11       |SFO   |4614                  |\n|12       |JFK   |2337                  |\n|12       |LAX   |6739                  |\n|12       |SFO   |6067                  |\n|13       |JFK   |2920                  |\n|13       |LAX   |5820                  |\n|13       |SFO   |5265                  |\n|14       |JFK   |1911                  |\n|14       |LAX   |5701                  |\n|14       |SFO   |4090                  |\n|15       |JFK   |3281                  |\n|15       |LAX   |5369                  |\n|15       |SFO   |4421                  |\n|16       |JFK   |7596                  |\n|16       |LAX   |6293                  |\n|16       |SFO   |3643                  |\n|17       |JFK   |6982                  |\n|17       |LAX   |5596                  |\n|17       |SFO   |2624                  |\n|18       |JFK   |4540                  |\n|18       |LAX   |7170                  |\n|18       |SFO   |4302                  |\n|19       |JFK   |6366                  |\n|19       |LAX   |4972                  |\n|19       |SFO   |2534                  |\n|20       |JFK   |6326                  |\n|20       |LAX   |5324                  |\n|20       |SFO   |3497                  |\n|21       |JFK   |3275                  |\n|21       |LAX   |4070                  |\n|21       |SFO   |2007                  |\n|22       |JFK   |1774                  |\n|22       |LAX   |4114                  |\n|22       |SFO   |3613                  |\n|23       |JFK   |277                   |\n|23       |LAX   |2381                  |\n|23       |SFO   |1131                  |\n+---------+------+----------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1492647953741_-1395462896","id":"20170420-002553_1807411798","dateCreated":"2017-04-20T00:25:53+0000","dateStarted":"2017-05-09T02:19:39+0000","dateFinished":"2017-05-09T02:22:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:276"},{"text":"import scala.collection.mutable.WrappedArray\r\nimport spark.implicits._\r\nimport org.apache.spark.sql.functions._\r\n\r\n val spark = org.apache.spark.sql.SparkSession.builder\r\n        .master(\"local\")\r\n        .appName(\"Spark CSV Reader\")\r\n        .getOrCreate;\r\n\r\nval ds2006 = spark.read\r\n        .format(\"com.databricks.spark.csv\")\r\n        .option(\"header\", \"true\") //reading the headers\r\n        .option(\"mode\", \"DROPMALFORMED\")\r\n        .load(\"/usr/nishchal/Nishchal/bigData/flight/2006.csv\"); \r\nval ds2007 = spark.read\r\n        .format(\"com.databricks.spark.csv\")\r\n        .option(\"header\", \"true\") //reading the headers\r\n        .option(\"mode\", \"DROPMALFORMED\")\r\n        .load(\"/usr/nishchal/Nishchal/bigData/flight/2007.csv\"); \r\n\r\nds2006.registerTempTable(\"flightDelays_2006\"); \r\nds2007.registerTempTable(\"flightDelays_2007\");\r\nval df2=spark.sql(\"select DayOfWeek,origin from flightDelays_2006 where DepDelay>=15 and Origin in ('JFK','LAX','SFO') union all select DayOfWeek,origin from flightDelays_2007 where DepDelay>=15 and Origin in ('JFK','LAX','SFO')\");\r\ndf2.registerTempTable(\"dayWiseDelays\");\r\nval df3=spark.sql(\"select DayOfWeek,origin,count(*) as numberOfFlightsDelayed from dayWiseDelays group by DayOfWeek,origin order by DayOfWeek,origin\");\r\ndf3.show();\r\n","user":"anonymous","dateUpdated":"2017-05-09T02:26:25+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport scala.collection.mutable.WrappedArray\n\nimport spark.implicits._\n\nimport org.apache.spark.sql.functions._\n\nspark: org.apache.spark.sql.SparkSession = org.apache.spark.sql.SparkSession@17f7ab8e\n\nds2006: org.apache.spark.sql.DataFrame = [Year: string, Month: string ... 27 more fields]\n\nds2007: org.apache.spark.sql.DataFrame = [Year: string, Month: string ... 27 more fields]\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\ndf2: org.apache.spark.sql.DataFrame = [DayOfWeek: string, origin: string]\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\ndf3: org.apache.spark.sql.DataFrame = [DayOfWeek: string, origin: string ... 1 more field]\n+---------+------+----------------------+\n|DayOfWeek|origin|numberOfFlightsDelayed|\n+---------+------+----------------------+\n|        1|   JFK|                  8626|\n|        1|   LAX|                 12248|\n|        1|   SFO|                  8860|\n|        2|   JFK|                  7137|\n|        2|   LAX|                 10122|\n|        2|   SFO|                  8248|\n|        3|   JFK|                  7869|\n|        3|   LAX|                 11025|\n|        3|   SFO|                  8267|\n|        4|   JFK|                  9114|\n|        4|   LAX|                 13444|\n|        4|   SFO|                  8708|\n|        5|   JFK|                 10745|\n|        5|   LAX|                 15459|\n|        5|   SFO|                 10141|\n|        6|   JFK|                  8346|\n|        6|   LAX|                 10348|\n|        6|   SFO|                  7435|\n|        7|   JFK|                  8764|\n|        7|   LAX|                 13799|\n+---------+------+----------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1494296379775_1256332002","id":"20170509-021939_11395857","dateCreated":"2017-05-09T02:19:39+0000","dateStarted":"2017-05-09T02:26:25+0000","dateFinished":"2017-05-09T02:28:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:277"},{"text":"import scala.collection.mutable.WrappedArray\r\nimport spark.implicits._\r\nimport org.apache.spark.sql.functions._\r\n\r\n val spark = org.apache.spark.sql.SparkSession.builder\r\n        .master(\"local\")\r\n        .appName(\"Spark CSV Reader\")\r\n        .getOrCreate;\r\n\r\nval ds2006 = spark.read\r\n        .format(\"com.databricks.spark.csv\")\r\n        .option(\"header\", \"true\") //reading the headers\r\n        .option(\"mode\", \"DROPMALFORMED\")\r\n        .load(\"/usr/nishchal/Nishchal/bigData/flight/2006.csv\"); \r\nval ds2007 = spark.read\r\n        .format(\"com.databricks.spark.csv\")\r\n        .option(\"header\", \"true\") //reading the headers\r\n        .option(\"mode\", \"DROPMALFORMED\")\r\n        .load(\"/usr/nishchal/Nishchal/bigData/flight/2007.csv\"); \r\n\r\nds2006.registerTempTable(\"flightDelays_2006\"); \r\nds2007.registerTempTable(\"flightDelays_2007\");\r\n\r\nval df2=spark.sql(\"select UniqueCarrier,origin, count(*) as number_of_delayed_flights from flightDelays_2006 where DepDelay>=15 and Origin in ('JFK','LAX','SFO') group by UniqueCarrier,origin UNION ALL select UniqueCarrier,origin, count(*) as number_of_delayed_flights from flightDelays_2007 where DepDelay>=15 and Origin in ('JFK','LAX','SFO') group by UniqueCarrier,origin\");\r\n\r\n\r\ndf2.registerTempTable(\"temp\");\r\n\r\nval df3=spark.sql(\"select sum(number_of_delayed_flights)as number_of_delayed_flights,origin,UniqueCarrier from temp group by origin,UniqueCarrier\");\r\n\r\ndf3.show();\r\n","user":"anonymous","dateUpdated":"2017-05-09T02:20:41+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport scala.collection.mutable.WrappedArray\n\nimport spark.implicits._\n\nimport org.apache.spark.sql.functions._\n\nspark: org.apache.spark.sql.SparkSession = org.apache.spark.sql.SparkSession@17f7ab8e\n\nds2006: org.apache.spark.sql.DataFrame = [Year: string, Month: string ... 27 more fields]\n\nds2007: org.apache.spark.sql.DataFrame = [Year: string, Month: string ... 27 more fields]\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\ndf2: org.apache.spark.sql.DataFrame = [UniqueCarrier: string, origin: string ... 1 more field]\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\ndf3: org.apache.spark.sql.DataFrame = [number_of_delayed_flights: bigint, origin: string ... 1 more field]\n+-------------------------+------+-------------+\n|number_of_delayed_flights|origin|UniqueCarrier|\n+-------------------------+------+-------------+\n|                      992|   JFK|           NW|\n|                       98|   LAX|           TZ|\n|                     1073|   SFO|           NW|\n|                    13606|   LAX|           AA|\n|                     3475|   LAX|           AS|\n|                     2544|   LAX|           US|\n|                        2|   LAX|           B6|\n|                      133|   SFO|           TZ|\n|                      481|   JFK|           CO|\n|                     2950|   SFO|           AS|\n|                    22321|   SFO|           OO|\n|                    13371|   JFK|           OH|\n|                     2624|   LAX|           CO|\n|                      635|   SFO|           MQ|\n|                     3964|   LAX|           MQ|\n|                      157|   JFK|           XE|\n|                       92|   SFO|           YV|\n|                      363|   LAX|           FL|\n|                      184|   LAX|           HA|\n|                    12808|   LAX|           UA|\n+-------------------------+------+-------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1494296401596_207521824","id":"20170509-022001_1010152933","dateCreated":"2017-05-09T02:20:01+0000","dateStarted":"2017-05-09T02:22:22+0000","dateFinished":"2017-05-09T02:24:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:278"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1494296441122_1157729014","id":"20170509-022041_1766503900","dateCreated":"2017-05-09T02:20:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:279","text":"\r\nimport scala.collection.mutable.WrappedArray\r\nimport spark.implicits._\r\nimport org.apache.spark.sql.functions._\r\n\r\n val spark = org.apache.spark.sql.SparkSession.builder\r\n        .master(\"local\")\r\n        .appName(\"Spark CSV Reader\")\r\n        .getOrCreate;\r\n\r\nval ds2006 = spark.read\r\n        .format(\"com.databricks.spark.csv\")\r\n        .option(\"header\", \"true\") //reading the headers\r\n        .option(\"mode\", \"DROPMALFORMED\")\r\n        .load(\"/usr/nishchal/Nishchal/bigData/flight/2006.csv\"); \r\nval ds2007 = spark.read\r\n        .format(\"com.databricks.spark.csv\")\r\n        .option(\"header\", \"true\") //reading the headers\r\n        .option(\"mode\", \"DROPMALFORMED\")\r\n        .load(\"/usr/nishchal/Nishchal/bigData/flight/2007.csv\"); \r\n\r\nds2006.registerTempTable(\"flightDelays_2006\"); \r\nds2007.registerTempTable(\"flightDelays_2007\");\r\n\r\nval df2=spark.sql(\"select year,month,origin, count(*) as number_of_delayed_flights from flightDelays_2006 where DepDelay>=15 and Origin in ('JFK','LAX','SFO') group by year,Month,origin UNION ALL select year,month,origin, count(*) as number_of_delayed_flights from flightDelays_2007 where DepDelay>=15 and Origin in ('JFK','LAX','SFO') group by year,Month,origin order by year,month\");\r\n\r\ndf2.show(72,false);\r\n","dateUpdated":"2017-05-10T22:43:29+0000","dateFinished":"2017-05-10T22:45:59+0000","dateStarted":"2017-05-10T22:43:30+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport scala.collection.mutable.WrappedArray\n\nimport spark.implicits._\n\nimport org.apache.spark.sql.functions._\n\nspark: org.apache.spark.sql.SparkSession = org.apache.spark.sql.SparkSession@46c2570b\n\nds2006: org.apache.spark.sql.DataFrame = [Year: string, Month: string ... 27 more fields]\n\nds2007: org.apache.spark.sql.DataFrame = [Year: string, Month: string ... 27 more fields]\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\ndf2: org.apache.spark.sql.DataFrame = [year: string, month: string ... 2 more fields]\n+----+-----+------+-------------------------+\n|year|month|origin|number_of_delayed_flights|\n+----+-----+------+-------------------------+\n|2006|1    |LAX   |3008                     |\n|2006|1    |JFK   |1924                     |\n|2006|1    |SFO   |2128                     |\n|2006|10   |JFK   |2444                     |\n|2006|10   |LAX   |3722                     |\n|2006|10   |SFO   |2174                     |\n|2006|11   |LAX   |3210                     |\n|2006|11   |SFO   |2559                     |\n|2006|11   |JFK   |2618                     |\n|2006|12   |SFO   |3016                     |\n|2006|12   |LAX   |4401                     |\n|2006|12   |JFK   |3257                     |\n|2006|2    |LAX   |3436                     |\n|2006|2    |SFO   |2474                     |\n|2006|2    |JFK   |1548                     |\n|2006|3    |JFK   |1470                     |\n|2006|3    |LAX   |4201                     |\n|2006|3    |SFO   |3403                     |\n|2006|4    |JFK   |1321                     |\n|2006|4    |LAX   |3518                     |\n|2006|4    |SFO   |2649                     |\n|2006|5    |LAX   |3007                     |\n|2006|5    |SFO   |1949                     |\n|2006|5    |JFK   |1255                     |\n|2006|6    |JFK   |2047                     |\n|2006|6    |SFO   |2530                     |\n|2006|6    |LAX   |3462                     |\n|2006|7    |SFO   |2287                     |\n|2006|7    |LAX   |3798                     |\n|2006|7    |JFK   |2860                     |\n|2006|8    |SFO   |2512                     |\n|2006|8    |JFK   |2595                     |\n|2006|8    |LAX   |3931                     |\n|2006|9    |LAX   |2970                     |\n|2006|9    |JFK   |2166                     |\n|2006|9    |SFO   |1898                     |\n|2007|1    |SFO   |2080                     |\n|2007|1    |JFK   |2865                     |\n|2007|1    |LAX   |3655                     |\n|2007|10   |JFK   |2110                     |\n|2007|10   |LAX   |3077                     |\n|2007|10   |SFO   |2823                     |\n|2007|11   |LAX   |3422                     |\n|2007|11   |JFK   |1967                     |\n|2007|11   |SFO   |2524                     |\n|2007|12   |JFK   |2947                     |\n|2007|12   |LAX   |5439                     |\n|2007|12   |SFO   |3432                     |\n|2007|2    |JFK   |2913                     |\n|2007|2    |LAX   |3754                     |\n|2007|2    |SFO   |2751                     |\n|2007|3    |JFK   |3664                     |\n|2007|3    |LAX   |3494                     |\n|2007|3    |SFO   |1805                     |\n|2007|4    |JFK   |3319                     |\n|2007|4    |SFO   |2126                     |\n|2007|4    |LAX   |3191                     |\n|2007|5    |JFK   |2477                     |\n|2007|5    |LAX   |2682                     |\n|2007|5    |SFO   |2287                     |\n|2007|6    |SFO   |2962                     |\n|2007|6    |LAX   |3779                     |\n|2007|6    |JFK   |3653                     |\n|2007|7    |SFO   |3185                     |\n|2007|7    |JFK   |3701                     |\n|2007|7    |LAX   |4360                     |\n|2007|8    |JFK   |3752                     |\n|2007|8    |LAX   |4212                     |\n|2007|8    |SFO   |3007                     |\n|2007|9    |SFO   |2173                     |\n|2007|9    |JFK   |1728                     |\n|2007|9    |LAX   |2716                     |\n+----+-----+------+-------------------------+\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1494456209994_-1799575990","id":"20170510-224329_1548451698","dateCreated":"2017-05-10T22:43:29+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:851"}],"name":"flight_delays","id":"2CETBXAJ3","angularObjects":{"2CGEN2PPR:shared_process":[],"2CDGZJUD5:shared_process":[],"2CGFHN8MN:shared_process":[],"2CDCCABW1:shared_process":[],"2CGEDRKPG:shared_process":[],"2CG32GDXQ:shared_process":[],"2CFETZ8ZY:shared_process":[],"2CEEZJ9VS:shared_process":[],"2CDJGPRYH:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}